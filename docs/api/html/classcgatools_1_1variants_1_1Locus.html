<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cgatools: cgatools::variants::Locus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacecgatools.html">cgatools</a>::<a class="el" href="namespacecgatools_1_1variants.html">variants</a>::<a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a>
  </div>
</div>
<div class="contents">
<h1>cgatools::variants::Locus Class Reference</h1><!-- doxytag: class="cgatools::variants::Locus" -->
<p>A class that corresponds to a single locus in a Complete Genomics variant file.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Locus_8hpp_source.html">Locus.hpp</a>&gt;</code></p>

<p><a href="classcgatools_1_1variants_1_1Locus-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49371dcf038727cfcc841aef364db2d0"></a><!-- doxytag: member="cgatools::variants::Locus::Locus" ref="a49371dcf038727cfcc841aef364db2d0" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a49371dcf038727cfcc841aef364db2d0">Locus</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a dummy locus (for use with std::vector, for example). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#acc51ffb3128be142aeac317a2902edfe">Locus</a> (const <a class="el" href="classcgatools_1_1reference_1_1CrrFile.html">CrrFile</a> &amp;crr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct an empty locus.  <a href="#acc51ffb3128be142aeac317a2902edfe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a26fb6f6594fe5ae2e3a6779be552f870">Locus</a> (const <a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a> &amp;other)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy and assignment must be overridden because <a class="el" href="classcgatools_1_1variants_1_1Allele.html" title="A class that corresponds to a single allele within a locus in a Complete Genomics...">Allele</a> has a pointer to this.  <a href="#a26fb6f6594fe5ae2e3a6779be552f870"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a62a8a9239f1d718fdd6e6f9042d871a3">operator=</a> (const <a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a> &amp;other)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy and assignment must be overridden because <a class="el" href="classcgatools_1_1variants_1_1Allele.html" title="A class that corresponds to a single allele within a locus in a Complete Genomics...">Allele</a> has a pointer to this.  <a href="#a62a8a9239f1d718fdd6e6f9042d871a3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#af89e395329f1027972ce9e28c1230f69">getCalls</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the calls for this locus, in order as found in the variant file.  <a href="#af89e395329f1027972ce9e28c1230f69"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a177cd9cf1f906074b9622d431a1bc79b">getCalls</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the calls for this locus, in order as found in the variant file.  <a href="#a177cd9cf1f906074b9622d431a1bc79b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c966311c7656474a1c4f3dcad55ca3e"></a><!-- doxytag: member="cgatools::variants::Locus::getAlleles" ref="a5c966311c7656474a1c4f3dcad55ca3e" args="() const " -->
const std::vector&lt; <a class="el" href="classcgatools_1_1variants_1_1Allele.html">Allele</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a5c966311c7656474a1c4f3dcad55ca3e">getAlleles</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the alleles for this locus, in order by haplotype. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3ed66a1a0bf76dd39600f5b5bcc1dc5"></a><!-- doxytag: member="cgatools::variants::Locus::getRange" ref="ae3ed66a1a0bf76dd39600f5b5bcc1dc5" args="() const " -->
const <a class="el" href="classcgatools_1_1reference_1_1Range.html">Range</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#ae3ed66a1a0bf76dd39600f5b5bcc1dc5">getRange</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the reference range for this locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af48d6274b3f382444775a6bb1dce049c"></a><!-- doxytag: member="cgatools::variants::Locus::setRange" ref="af48d6274b3f382444775a6bb1dce049c" args="(const Range &amp;range)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#af48d6274b3f382444775a6bb1dce049c">setRange</a> (const <a class="el" href="classcgatools_1_1reference_1_1Range.html">Range</a> &amp;range)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set range, only for loci with one call. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae350736da318a96b399b5565bf19e027"></a><!-- doxytag: member="cgatools::variants::Locus::getReference" ref="ae350736da318a96b399b5565bf19e027" args="() const " -->
const <a class="el" href="classcgatools_1_1reference_1_1CrrFile.html">CrrFile</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#ae350736da318a96b399b5565bf19e027">getReference</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the reference crr file associated with this locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f0eafbab7f07c326e0fcef6853b1c6d"></a><!-- doxytag: member="cgatools::variants::Locus::getId" ref="a0f0eafbab7f07c326e0fcef6853b1c6d" args="() const " -->
boost::uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a0f0eafbab7f07c326e0fcef6853b1c6d">getId</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the locus id (locus column in the variant file). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a9ce64f326cb4e4ab982ccab9bda11aa0">setId</a> (boost::uint32_t locusId)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the locus id (locus column in the variant file).  <a href="#a9ce64f326cb4e4ab982ccab9bda11aa0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2e3dd46d6a7fb41fa90bd44bb15cbda6"></a><!-- doxytag: member="cgatools::variants::Locus::getPloidy" ref="a2e3dd46d6a7fb41fa90bd44bb15cbda6" args="() const " -->
boost::uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a2e3dd46d6a7fb41fa90bd44bb15cbda6">getPloidy</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the ploidy of this locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abde7c5f058c1513ecf4105c24a044ced"></a><!-- doxytag: member="cgatools::variants::Locus::setHapLink" ref="abde7c5f058c1513ecf4105c24a044ced" args="(size_t alleleOffset, const std::string &amp;hapLink)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#abde7c5f058c1513ecf4105c24a044ced">setHapLink</a> (size_t alleleOffset, const std::string &amp;hapLink)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update all the hapLinks for the given allele of this locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a8bbc6fc90a4634086dd742d63c948ffe">isRefCallLocus</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true iff this locus is a one-call reference-called locus.  <a href="#a8bbc6fc90a4634086dd742d63c948ffe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a69be5b9b713c115327cfcefdcab51485"></a><!-- doxytag: member="cgatools::variants::Locus::isNoCallLocus" ref="a69be5b9b713c115327cfcefdcab51485" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a69be5b9b713c115327cfcefdcab51485">isNoCallLocus</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true iff this locus is a one-call no-called locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#af336487a2345667f471dd474358f6050">isRefConsistent</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true iff each call in this locus is consistent with the reference.  <a href="#af336487a2345667f471dd474358f6050"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#abab1df84bab13c9141185435e24ce9f9">hasNoCalls</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true iff this locus has one or more calls whose sequence contains N or ? characters.  <a href="#abab1df84bab13c9141185435e24ce9f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#ab69c13ca68035a5ebf69a3c4d6be944d">computeReadCounts</a> (<a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *allele1ReadCount, <a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *allele2ReadCount, <a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *referenceAlleleReadCount, <a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *totalReadCount, <a class="el" href="classcgatools_1_1cgdata_1_1EvidenceReader.html">cgdata::EvidenceReader</a> &amp;evidence) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the requested read counts, or -1 if this read count is empty as annotated in a masterVar file.  <a href="#ab69c13ca68035a5ebf69a3c4d6be944d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1fb6fcfd21cf12a71e5ae0195e215c95"></a><!-- doxytag: member="cgatools::variants::Locus::clearCalls" ref="a1fb6fcfd21cf12a71e5ae0195e215c95" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a1fb6fcfd21cf12a71e5ae0195e215c95">clearCalls</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clears the set of calls for this locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abb814fcb6be9bd9744c9d8fa2922d045"></a><!-- doxytag: member="cgatools::variants::Locus::addCall" ref="abb814fcb6be9bd9744c9d8fa2922d045" args="(const Call &amp;call)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#abb814fcb6be9bd9744c9d8fa2922d045">addCall</a> (const <a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a> &amp;call)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a call to the locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#ab3b7be9a7e86ffa3ce84b730e8fc5f69">initFromCalls</a> (bool relaxedReferenceValidation=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">After adding calls by <a class="el" href="classcgatools_1_1variants_1_1Locus.html#abb814fcb6be9bd9744c9d8fa2922d045" title="Adds a call to the locus.">Locus::addCall()</a>, this function must be called to prepare the <a class="el" href="classcgatools_1_1variants_1_1Locus.html" title="A class that corresponds to a single locus in a Complete Genomics variant file.">Locus</a> for use.  <a href="#ab3b7be9a7e86ffa3ce84b730e8fc5f69"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a2d8b4ce04609923715e035814813ab79">locationCalls</a> (const <a class="el" href="classcgatools_1_1reference_1_1Location.html">Location</a> &amp;loc, std::vector&lt; std::pair&lt; char, const <a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a> * &gt; &gt; &amp;calls) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns in the calls parameter the bases called by this locus at the specified location (or - or ., in accordance with snpdiff interpretation of those values), as well as the <a class="el" href="structcgatools_1_1variants_1_1Call.html" title="A struct that corresponds to a single line of a Complete Genomics variant file.">Call</a> used to determine each base call.  <a href="#a2d8b4ce04609923715e035814813ab79"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a34bce68e43f9c4793131128fe6c56b4a"></a><!-- doxytag: member="cgatools::variants::Locus::getType" ref="a34bce68e43f9c4793131128fe6c56b4a" args="() const " -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a34bce68e43f9c4793131128fe6c56b4a">getType</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns locus type, as specified for simplified variation files. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20a89345e13428221fc010c97fbe4e84"></a><!-- doxytag: member="cgatools::variants::Locus::setType" ref="a20a89345e13428221fc010c97fbe4e84" args="(const std::string &amp;olplType)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a20a89345e13428221fc010c97fbe4e84">setType</a> (const std::string &amp;olplType)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the masterVar varType for this locus. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e1ede337be0592899ca7e2bac755763"></a><!-- doxytag: member="cgatools::variants::Locus::getZygosity" ref="a4e1ede337be0592899ca7e2bac755763" args="() const " -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a4e1ede337be0592899ca7e2bac755763">getZygosity</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns locus zygosity, as specified for simplified variation files. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#afef3f68698d5462ea6689580345cb6e0">reorderAlleles</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Changes the allele order to the one specified for simplified variation files (i.e.  <a href="#afef3f68698d5462ea6689580345cb6e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a28914f3f4ba2f7ab03b3b3899babc551">writeAsOneLine</a> (std::ostream &amp;out, bool writeExtras=true, char sep= '\t') const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Writes this locus to the stream in the format specified for simplified one-line-per-locus variation files.  <a href="#a28914f3f4ba2f7ab03b3b3899babc551"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e2293f38306b4825b15b7a91f96d7ba"></a><!-- doxytag: member="cgatools::variants::Locus::hasAnnotation" ref="a0e2293f38306b4825b15b7a91f96d7ba" args="(const std::string &amp;name) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a0e2293f38306b4825b15b7a91f96d7ba">hasAnnotation</a> (const std::string &amp;name) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true iff this locus has the given masterVar annotation. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::string &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#abe5760d39d8685c21dfbbc8d39e50766">getAnnotation</a> (const std::string &amp;name) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the masterVar annotation with the given name.  <a href="#abe5760d39d8685c21dfbbc8d39e50766"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a9f17781ad7065873d104360a5b924286">getAllXRef</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the union of xRef annotations for all Calls in this <a class="el" href="classcgatools_1_1variants_1_1Locus.html" title="A class that corresponds to a single locus in a Complete Genomics variant file.">Locus</a>, joined by ";".  <a href="#a9f17781ad7065873d104360a5b924286"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a1fea2319fff5859ad4cf0334ea3ecd60">xRefIsAlleleSpecific</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns false if this is a masterVar with xRef annotation but not allele1XRef or allele2XRef.  <a href="#a1fea2319fff5859ad4cf0334ea3ecd60"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4662bf194503db31406f12099f203b20"></a><!-- doxytag: member="cgatools::variants::Locus::setLocusAnnotations" ref="a4662bf194503db31406f12099f203b20" args="(const LocusAnnotations &amp;ann)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#a4662bf194503db31406f12099f203b20">setLocusAnnotations</a> (const <a class="el" href="classcgatools_1_1variants_1_1LocusAnnotations.html">LocusAnnotations</a> &amp;ann)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the locus annotations for this locus. <br/></td></tr>
<tr><td colspan="2"><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abeb24c86231d7664656958dd643232e9"></a><!-- doxytag: member="cgatools::variants::Locus::writeOneLineFileHeader" ref="abeb24c86231d7664656958dd643232e9" args="(std::ostream &amp;out, bool alleleSpecificXRef, char sep= '\t')" -->
static void&nbsp;</td><td class="memItemRight" valign="bottom"><b>writeOneLineFileHeader</b> (std::ostream &amp;out, bool alleleSpecificXRef, char sep= '\t')</td></tr>
<tr><td colspan="2"><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af189c29cb82bfaa70a3832d48a80d053"></a><!-- doxytag: member="cgatools::variants::Locus::extras_" ref="af189c29cb82bfaa70a3832d48a80d053" args="" -->
std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1variants_1_1Locus.html#af189c29cb82bfaa70a3832d48a80d053">extras_</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Additional annotation columns. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>A class that corresponds to a single locus in a Complete Genomics variant file. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="acc51ffb3128be142aeac317a2902edfe"></a><!-- doxytag: member="cgatools::variants::Locus::Locus" ref="acc51ffb3128be142aeac317a2902edfe" args="(const CrrFile &amp;crr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cgatools::variants::Locus::Locus </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcgatools_1_1reference_1_1CrrFile.html">CrrFile</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>crr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Construct an empty locus. </p>
<p>The <a class="el" href="classcgatools_1_1variants_1_1Locus.html" title="A class that corresponds to a single locus in a Complete Genomics variant file.">Locus</a> cannot be used until its calls have been added by <a class="el" href="classcgatools_1_1variants_1_1Locus.html#abb814fcb6be9bd9744c9d8fa2922d045" title="Adds a call to the locus.">Locus::addCall()</a> and it has been initialized by <a class="el" href="classcgatools_1_1variants_1_1Locus.html#ab3b7be9a7e86ffa3ce84b730e8fc5f69" title="After adding calls by Locus::addCall(), this function must be called to prepare the...">Locus::initFromCalls()</a>. </p>

</div>
</div>
<a class="anchor" id="a26fb6f6594fe5ae2e3a6779be552f870"></a><!-- doxytag: member="cgatools::variants::Locus::Locus" ref="a26fb6f6594fe5ae2e3a6779be552f870" args="(const Locus &amp;other)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cgatools::variants::Locus::Locus </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>other</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy and assignment must be overridden because <a class="el" href="classcgatools_1_1variants_1_1Allele.html" title="A class that corresponds to a single allele within a locus in a Complete Genomics...">Allele</a> has a pointer to this. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab69c13ca68035a5ebf69a3c4d6be944d"></a><!-- doxytag: member="cgatools::variants::Locus::computeReadCounts" ref="ab69c13ca68035a5ebf69a3c4d6be944d" args="(int32_t *allele1ReadCount, int32_t *allele2ReadCount, int32_t *referenceAlleleReadCount, int32_t *totalReadCount, cgdata::EvidenceReader &amp;evidence) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgatools::variants::Locus::computeReadCounts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>allele1ReadCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>allele2ReadCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>referenceAlleleReadCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecgatools.html#a1dc8797bc1a0c22634c5ffd30fa584d3">int32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>totalReadCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcgatools_1_1cgdata_1_1EvidenceReader.html">cgdata::EvidenceReader</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>evidence</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the requested read counts, or -1 if this read count is empty as annotated in a masterVar file. </p>
<p>This function computes read counts from the evidence, regardless of whether or not this locus is annotated with read counts. For a function that can use the masterVar annotation if available, see <a class="el" href="classcgatools_1_1variants_1_1VariantFileIterator.html#a946210910bf8c4ea6588542da376ca11" title="Returns the requested read counts, as defined in the masterVar file, or -1 if this...">VariantFileIterator::getReadCounts()</a>. </p>

</div>
</div>
<a class="anchor" id="a9f17781ad7065873d104360a5b924286"></a><!-- doxytag: member="cgatools::variants::Locus::getAllXRef" ref="a9f17781ad7065873d104360a5b924286" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string cgatools::variants::Locus::getAllXRef </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the union of xRef annotations for all Calls in this <a class="el" href="classcgatools_1_1variants_1_1Locus.html" title="A class that corresponds to a single locus in a Complete Genomics variant file.">Locus</a>, joined by ";". </p>

</div>
</div>
<a class="anchor" id="abe5760d39d8685c21dfbbc8d39e50766"></a><!-- doxytag: member="cgatools::variants::Locus::getAnnotation" ref="abe5760d39d8685c21dfbbc8d39e50766" args="(const std::string &amp;name) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string&amp; cgatools::variants::Locus::getAnnotation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the masterVar annotation with the given name. </p>
<p>If the annotation is not available, returns empty string. </p>

</div>
</div>
<a class="anchor" id="a177cd9cf1f906074b9622d431a1bc79b"></a><!-- doxytag: member="cgatools::variants::Locus::getCalls" ref="a177cd9cf1f906074b9622d431a1bc79b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a>&gt;&amp; cgatools::variants::Locus::getCalls </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve the calls for this locus, in order as found in the variant file. </p>

</div>
</div>
<a class="anchor" id="af89e395329f1027972ce9e28c1230f69"></a><!-- doxytag: member="cgatools::variants::Locus::getCalls" ref="af89e395329f1027972ce9e28c1230f69" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a>&gt;&amp; cgatools::variants::Locus::getCalls </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve the calls for this locus, in order as found in the variant file. </p>

</div>
</div>
<a class="anchor" id="abab1df84bab13c9141185435e24ce9f9"></a><!-- doxytag: member="cgatools::variants::Locus::hasNoCalls" ref="abab1df84bab13c9141185435e24ce9f9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cgatools::variants::Locus::hasNoCalls </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns true iff this locus has one or more calls whose sequence contains N or ? characters. </p>

</div>
</div>
<a class="anchor" id="ab3b7be9a7e86ffa3ce84b730e8fc5f69"></a><!-- doxytag: member="cgatools::variants::Locus::initFromCalls" ref="ab3b7be9a7e86ffa3ce84b730e8fc5f69" args="(bool relaxedReferenceValidation=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgatools::variants::Locus::initFromCalls </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>relaxedReferenceValidation</em> = <code>true</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>After adding calls by <a class="el" href="classcgatools_1_1variants_1_1Locus.html#abb814fcb6be9bd9744c9d8fa2922d045" title="Adds a call to the locus.">Locus::addCall()</a>, this function must be called to prepare the <a class="el" href="classcgatools_1_1variants_1_1Locus.html" title="A class that corresponds to a single locus in a Complete Genomics variant file.">Locus</a> for use. </p>

</div>
</div>
<a class="anchor" id="a8bbc6fc90a4634086dd742d63c948ffe"></a><!-- doxytag: member="cgatools::variants::Locus::isRefCallLocus" ref="a8bbc6fc90a4634086dd742d63c948ffe" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cgatools::variants::Locus::isRefCallLocus </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns true iff this locus is a one-call reference-called locus. </p>

</div>
</div>
<a class="anchor" id="af336487a2345667f471dd474358f6050"></a><!-- doxytag: member="cgatools::variants::Locus::isRefConsistent" ref="af336487a2345667f471dd474358f6050" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cgatools::variants::Locus::isRefConsistent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns true iff each call in this locus is consistent with the reference. </p>

</div>
</div>
<a class="anchor" id="a2d8b4ce04609923715e035814813ab79"></a><!-- doxytag: member="cgatools::variants::Locus::locationCalls" ref="a2d8b4ce04609923715e035814813ab79" args="(const Location &amp;loc, std::vector&lt; std::pair&lt; char, const Call * &gt; &gt; &amp;calls) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgatools::variants::Locus::locationCalls </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcgatools_1_1reference_1_1Location.html">Location</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; char, const <a class="el" href="structcgatools_1_1variants_1_1Call.html">Call</a> * &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>calls</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns in the calls parameter the bases called by this locus at the specified location (or - or ., in accordance with snpdiff interpretation of those values), as well as the <a class="el" href="structcgatools_1_1variants_1_1Call.html" title="A struct that corresponds to a single line of a Complete Genomics variant file.">Call</a> used to determine each base call. </p>

</div>
</div>
<a class="anchor" id="a62a8a9239f1d718fdd6e6f9042d871a3"></a><!-- doxytag: member="cgatools::variants::Locus::operator=" ref="a62a8a9239f1d718fdd6e6f9042d871a3" args="(const Locus &amp;other)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a>&amp; cgatools::variants::Locus::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcgatools_1_1variants_1_1Locus.html">Locus</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>other</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy and assignment must be overridden because <a class="el" href="classcgatools_1_1variants_1_1Allele.html" title="A class that corresponds to a single allele within a locus in a Complete Genomics...">Allele</a> has a pointer to this. </p>

</div>
</div>
<a class="anchor" id="afef3f68698d5462ea6689580345cb6e0"></a><!-- doxytag: member="cgatools::variants::Locus::reorderAlleles" ref="afef3f68698d5462ea6689580345cb6e0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgatools::variants::Locus::reorderAlleles </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Changes the allele order to the one specified for simplified variation files (i.e. </p>
<p>"more interesting allele first"). </p>

</div>
</div>
<a class="anchor" id="a9ce64f326cb4e4ab982ccab9bda11aa0"></a><!-- doxytag: member="cgatools::variants::Locus::setId" ref="a9ce64f326cb4e4ab982ccab9bda11aa0" args="(boost::uint32_t locusId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgatools::variants::Locus::setId </td>
          <td>(</td>
          <td class="paramtype">boost::uint32_t&nbsp;</td>
          <td class="paramname"> <em>locusId</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the locus id (locus column in the variant file). </p>
<p>This updates all calls in the locus. </p>

</div>
</div>
<a class="anchor" id="a28914f3f4ba2f7ab03b3b3899babc551"></a><!-- doxytag: member="cgatools::variants::Locus::writeAsOneLine" ref="a28914f3f4ba2f7ab03b3b3899babc551" args="(std::ostream &amp;out, bool writeExtras=true, char sep= '\t') const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cgatools::variants::Locus::writeAsOneLine </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>writeExtras</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>sep</em> = <code>'\t'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes this locus to the stream in the format specified for simplified one-line-per-locus variation files. </p>

</div>
</div>
<a class="anchor" id="a1fea2319fff5859ad4cf0334ea3ecd60"></a><!-- doxytag: member="cgatools::variants::Locus::xRefIsAlleleSpecific" ref="a1fea2319fff5859ad4cf0334ea3ecd60" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cgatools::variants::Locus::xRefIsAlleleSpecific </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns false if this is a masterVar with xRef annotation but not allele1XRef or allele2XRef. </p>
<p>(True in older masterVar files.) Otherwise, returns true. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="Locus_8hpp_source.html">Locus.hpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
