<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cgatools: cgatools::util::IntervalTree&lt; TRange, TBoundary, TValue, Overlap, GetBoundary, BoundaryLess &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacecgatools.html">cgatools</a>::<a class="el" href="namespacecgatools_1_1util.html">util</a>::<a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">IntervalTree</a>
  </div>
</div>
<div class="contents">
<h1>cgatools::util::IntervalTree&lt; TRange, TBoundary, TValue, Overlap, GetBoundary, BoundaryLess &gt; Class Template Reference</h1><!-- doxytag: class="cgatools::util::IntervalTree" -->
<p>Class that maintains a mapping from key to value, where the key is a type with range semantics, for the purpose of finding the intersection of a range to a set of ranges.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="RangeIntersector_8hpp_source.html">RangeIntersector.hpp</a>&gt;</code></p>

<p><a href="classcgatools_1_1util_1_1IntervalTree-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>Node</b></td></tr>
<tr><td colspan="2"><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8a171bf8defd580bfc15034643624c3d"></a><!-- doxytag: member="cgatools::util::IntervalTree::MyType" ref="a8a171bf8defd580bfc15034643624c3d" args="" -->
typedef <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">IntervalTree</a>&lt; TRange, <br class="typebreak"/>
TBoundary, TValue, Overlap, <br class="typebreak"/>
GetBoundary, BoundaryLess &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>MyType</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8c34de62cc1ec948ddeb47498f7b04cc"></a><!-- doxytag: member="cgatools::util::IntervalTree::value_type" ref="a8c34de62cc1ec948ddeb47498f7b04cc" args="" -->
typedef std::pair&lt; const <br class="typebreak"/>
TRange, TValue &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>value_type</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a58286f27dbe11582fec018ade3316ba4"></a><!-- doxytag: member="cgatools::util::IntervalTree::QueryResultType" ref="a58286f27dbe11582fec018ade3316ba4" args="" -->
typedef const value_type *&nbsp;</td><td class="memItemRight" valign="bottom"><b>QueryResultType</b></td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e8cc12406544cd14edd0da475158e0d"></a><!-- doxytag: member="cgatools::util::IntervalTree::IntervalTree" ref="a0e8cc12406544cd14edd0da475158e0d" args="(const Overlap &amp;overlap=Overlap(), const GetBoundary &amp;getBoundary=GetBoundary(), const BoundaryLess &amp;boundaryLess=BoundaryLess())" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a0e8cc12406544cd14edd0da475158e0d">IntervalTree</a> (const Overlap &amp;overlap=Overlap(), const GetBoundary &amp;getBoundary=GetBoundary(), const BoundaryLess &amp;boundaryLess=BoundaryLess())</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates empty tree. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a359d971481b44bcb6a70eb7bc663b53c"></a><!-- doxytag: member="cgatools::util::IntervalTree::IntervalTree" ref="a359d971481b44bcb6a70eb7bc663b53c" args="(const MyType &amp;rhs)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a359d971481b44bcb6a70eb7bc663b53c">IntervalTree</a> (const <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">MyType</a> &amp;rhs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor. Provides value copy semantics. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1df476d3465d2f5c6818cd07e7a3d080"></a><!-- doxytag: member="cgatools::util::IntervalTree::operator=" ref="a1df476d3465d2f5c6818cd07e7a3d080" args="(const MyType &amp;rhs)" -->
const <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">MyType</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a1df476d3465d2f5c6818cd07e7a3d080">operator=</a> (const <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">MyType</a> &amp;rhs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assignment. Provides value copy semantics. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a18851cb69d286f3f116043d7ef07fe41"></a><!-- doxytag: member="cgatools::util::IntervalTree::put" ref="a18851cb69d286f3f116043d7ef07fe41" args="(const TRange &amp;range, const TValue &amp;value)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a18851cb69d286f3f116043d7ef07fe41">put</a> (const TRange &amp;range, const TValue &amp;value)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a range to the set. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a7786d6d2edf95400f6a2067c6a1aa9be">intersect</a> (const TRange &amp;range, std::vector&lt; QueryResultType &gt; &amp;result) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the intersection of the given range with all the ranges in the set.  <a href="#a7786d6d2edf95400f6a2067c6a1aa9be"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a748a948bf7d5aa859e6d30383d96cb87"></a><!-- doxytag: member="cgatools::util::IntervalTree::size" ref="a748a948bf7d5aa859e6d30383d96cb87" args="() const " -->
size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a748a948bf7d5aa859e6d30383d96cb87">size</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of ranges in the tree. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7da64d16d435056fcd184ef629e24498"></a><!-- doxytag: member="cgatools::util::IntervalTree::swap" ref="a7da64d16d435056fcd184ef629e24498" args="(MyType &amp;rhs)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a7da64d16d435056fcd184ef629e24498">swap</a> (<a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">MyType</a> &amp;rhs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Swaps the internals of this tree with another. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5706a7550edb8257dde2253c24824a40"></a><!-- doxytag: member="cgatools::util::IntervalTree::clear" ref="a5706a7550edb8257dde2253c24824a40" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a5706a7550edb8257dde2253c24824a40">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clear all data. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#af025a7b07481344bcc818f3f901bf29b">getMaxDepth</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Debug function: returns tree depth and validates the tree structure.  <a href="#af025a7b07481344bcc818f3f901bf29b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;typename TRange, typename TBoundary, typename TValue, typename Overlap, typename GetBoundary, typename BoundaryLess = std::less&lt;TBoundary&gt;&gt;<br/>
 class cgatools::util::IntervalTree&lt; TRange, TBoundary, TValue, Overlap, GetBoundary, BoundaryLess &gt;</h3>

<p>Class that maintains a mapping from key to value, where the key is a type with range semantics, for the purpose of finding the intersection of a range to a set of ranges. </p>
<p>Requirements:</p>
<ul>
<li>TRange class {a, b} with two boundaries a and b of type TBoundary with strict total order defined by BoundaryLess operator. Boundaries of a given range are obtained using GetBoundary operator that takes the range as the first argument and the boundary index (0/1) as the second argument.</li>
<li>Overlap operator such that {a, b} never overlaps {x, y} if b &lt; x. This implementation uses an RB-tree where every node is augmented with the maximum upper range boundary for all ranges in the subtree defined by the node (see CLR book section 15.3, "Interval trees"). The RB-tree itself is a left-leaning RB-tree variant described by Robert Sedgewick: <a href="http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf">http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf</a> . The implementation is adopted from: <a href="http://www.cs.princeton.edu/~rs/talks/LLRB/Java/RedBlackBST.java">http://www.cs.princeton.edu/~rs/talks/LLRB/Java/RedBlackBST.java</a> . NOTES:</li>
<li>Currently the tree orders ranges on left boundary and nothing else. Since <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html#a7786d6d2edf95400f6a2067c6a1aa9be" title="Find the intersection of the given range with all the ranges in the set.">intersect()</a> returns ranges in the tree order, it may be useful to allow custom comparators for TRange; however, they'd still need to order on the left boundary first for correctness.</li>
<li>For now I limited the interface to what the old RangeIntersector used to provide; feel free to extend it as needed.</li>
<li>There are no parent pointers, so if we ever need iterators, we will need to maintain stacks in them (or add parent pointers, which is somewhat costly). </li>
</ul>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="af025a7b07481344bcc818f3f901bf29b"></a><!-- doxytag: member="cgatools::util::IntervalTree::getMaxDepth" ref="af025a7b07481344bcc818f3f901bf29b" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TRange, typename TBoundary, typename TValue, typename Overlap, typename GetBoundary, typename BoundaryLess = std::less&lt;TBoundary&gt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">cgatools::util::IntervalTree</a>&lt; TRange, TBoundary, TValue, Overlap, GetBoundary, BoundaryLess &gt;::getMaxDepth </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Debug function: returns tree depth and validates the tree structure. </p>

</div>
</div>
<a class="anchor" id="a7786d6d2edf95400f6a2067c6a1aa9be"></a><!-- doxytag: member="cgatools::util::IntervalTree::intersect" ref="a7786d6d2edf95400f6a2067c6a1aa9be" args="(const TRange &amp;range, std::vector&lt; QueryResultType &gt; &amp;result) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TRange, typename TBoundary, typename TValue, typename Overlap, typename GetBoundary, typename BoundaryLess = std::less&lt;TBoundary&gt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classcgatools_1_1util_1_1IntervalTree.html">cgatools::util::IntervalTree</a>&lt; TRange, TBoundary, TValue, Overlap, GetBoundary, BoundaryLess &gt;::intersect </td>
          <td>(</td>
          <td class="paramtype">const TRange &amp;&nbsp;</td>
          <td class="paramname"> <em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; QueryResultType &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find the intersection of the given range with all the ranges in the set. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="RangeIntersector_8hpp_source.html">RangeIntersector.hpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
